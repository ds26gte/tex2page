% last modified 2016-12-21

\let\maybeendinput\relax
\ifx\shipout\UnDeFiNeD
  \let\maybeendinput\endinput
\else\edef\fmtnameQplain{plain}%
  \ifx\fmtname\fmtnameQplain\else
    \let\maybeendinput\endinput
  \fi
\fi\maybeendinput

\ifx\definecolor\UnDeFiNeD
  \ifx\miniltx\UnDeFiNeD
    \input miniltx
  \fi
  \input color.sty
\fi

\let\colorQorig\color

\let\definecolorQorig\definecolor

\def\color{\futurelet\colorQi\colorQii}

\def\colorQii{\ifx\colorQi[\let\colorQiii\colorQwithmodel
\else\let\colorQiii\colorQorig\fi\colorQiii}

\def\colorQwithmodel[#1]#2{%
  \edef\colorQmodel{#1}%
  \edef\colorQvalues{#2}%
  \colorQconvertmodel
  \edef\colorQtemp{\noexpand\colorQorig[\colorQmodel]{\colorQvalues}}%
  \colorQtemp}

\def\definecolor#1#2#3{%
  \edef\colorQmodel{#2}%
  \edef\colorQvalues{#3}%
  \colorQconvertmodel
  \edef\colorQtemp{\noexpand\definecolorQorig{#1}{\colorQmodel}{\colorQvalues}}%
  \colorQtemp}

\def\colorQconvertmodel{%
  %
  \edef\colorQmodelcmy{cmy}%
  \edef\colorQmodelGray{Gray}%
  \edef\colorQmodelHsb{Hsb}%
  \edef\colorQmodelHSB{HSB}%
  \edef\colorQmodelHTML{HTML}%
  \edef\colorQmodelwave{wave}%
  %
  \ifx\colorQmodel\colorQmodelcmy
    \expandafter\colorQconvertcmy\colorQvalues\relax
  \else\ifx\colorQmodel\colorQmodelGray
    \expandafter\colorQconvertGray\colorQvalues\relax
  \else\ifx\colorQmodel\colorQmodelHsb
    \expandafter\colorQconvertHsb\colorQvalues\relax
  \else\ifx\colorQmodel\colorQmodelHSB
    \expandafter\colorQconvertHSB\colorQvalues\relax
  \else\ifx\colorQmodel\colorQmodelHTML
    \expandafter\colorQconvertHTML\colorQvalues\relax
  \else\ifx\colorQmodel\colorQmodelwave
    \expandafter\colorQconvertwave\colorQvalues\relax
  \fi\fi\fi\fi\fi\fi}

% cmy

{\catcode`\@=11
\gdef\colorQconvertcmy #1,#2,#3\relax{%
  %
  \dimen@=#1\p@
  \advance\dimen@ -1pt
  \multiply\dimen@ -1
  \edef\colorQred{\strip@pt\dimen@}%
  %
  \dimen@=#2\p@
  \advance\dimen@ -1pt
  \multiply\dimen@ -1
  \edef\colorQgreen{\strip@pt\dimen@}%
  %
  \dimen@=#3\p@
  \advance\dimen@ -1pt
  \multiply\dimen@ -1
  \edef\colorQblue{\strip@pt\dimen@}%
  %
  \edef\colorQmodel{rgb}%
  \edef\colorQvalues{\colorQred,\colorQgreen,\colorQblue}}}

% Gray

{\catcode`\@=11
\gdef\colorQconvertGray #1\relax{%
  \dimen@=#1\p@
  \divide\dimen@ 15
  \edef\colorQgray{\strip@pt\dimen@}%
  %
  \edef\colorQmodel{gray}%
  \edef\colorQvalues{\colorQgray}}}

% Hsb

{\catcode`\@=11
\gdef\colorQconvertHsb #1,#2,#3\relax{%
  \dimen@=#1\p@
  \divide\dimen@ 360
  \edef\colorQhue{\strip@pt\dimen@}%
  \dimen@=#2\p@
  \edef\colorQsat{\strip@pt\dimen@}%
  \dimen@=#3\p@
  \edef\colorQbright{\strip@pt\dimen@}%
  %
  \edef\colorQmodel{hsb}%
  \edef\colorQvalues{\colorQhue,\colorQsat,\colorQbright}}}

% HSB

{\catcode`\@=11
\gdef\colorQconvertHSB #1,#2,#3\relax{%
  %
  \dimen@=#1\p@
  \divide\dimen@ 240
  \edef\colorQhue{\strip@pt\dimen@}%
  %
  \dimen@=#2\p@
  \divide\dimen@ 240
  \edef\colorQsat{\strip@pt\dimen@}%
  %
  \dimen@=#3\p@
  \divide\dimen@ 240
  \edef\colorQbright{\strip@pt\dimen@}%
  %
  \edef\colorQmodel{hsb}%
  \edef\colorQvalues{\colorQhue,\colorQsat,\colorQbright}}}

% HTML

\def\colorQconvertHTML #1#2#3#4#5#6\relax{%
  \edef\colorQred{\number"#1#2}%
  \edef\colorQgreen{\number"#3#4}%
  \edef\colorQblue{\number"#5#6}%
  %
  \edef\colorQmodel{RGB}%
  \edef\colorQvalues{\colorQred,\colorQgreen,\colorQblue}}

% wave

{\catcode`@=11
\gdef\colorQconvertwave #1\relax{%
  %
  \dimen@=#1\p@
  \ifdim\dimen@<362.857pt
    \dimen@=5pt
  \else\ifdim\dimen@=362.857pt
    \dimen@=5pt
  \else\ifdim\dimen@<440pt
    \advance\dimen@ -440pt
    \divide\dimen@ -60
    \advance\dimen@ 4pt
  \else\ifdim\dimen@<490pt
    \advance\dimen@ -440pt
    \divide\dimen@ 50
    \multiply\dimen@ -1
    \advance\dimen@ 4pt
  \else\ifdim\dimen@<510pt
    \advance\dimen@ 510pt
    \divide\dimen@ -20
    \advance\dimen@ 2pt
  \else\ifdim\dimen@<580pt
    \advance\dimen@ -510pt
    \divide\dimen@ -70
    \multiply\dimen@ -1
    \advance\dimen@ 2pt
  \else\ifdim\dimen@<645pt
    \advance\dimen@ -645pt
    \divide\dimen@ -65
  \else
    \dimen@=0pt
  \fi\fi\fi\fi\fi\fi\fi
  \divide\dimen@ 6
  \edef\colorQhue{\strip@pt\dimen@}%
  %
  \dimen@=#1\p@
  \ifdim\dimen@<362.857pt
    \dimen@=0pt
  \else\ifdim\dimen@=362.857pt
    \dimen@=0pt
  \else\ifdim\dimen@<420pt
    \advance\dimen@ 380pt
    \divide\dimen@ 40
    \multiply\dimen@ .7
    \advance\dimen@ .3pt
  \else\ifdim\dimen@<700pt
    \dimen@=1pt
  \else\ifdim\dimen@=700pt
    \dimen@=1pt
  \else\ifdim\dimen@<814.285pt
    \advance\dimen@ -780
    \divide\dimen@ -80
    \multiply\dimen@ .7
    \advance\dimen@ .3pt
  \else
    \dimen@=0pt
  \fi\fi\fi\fi\fi\fi
  \edef\colorQbright{\strip@pt\dimen@}%
  %
  \edef\colorQmodel{hsb}%
  \edef\colorQvalues{\colorQhue,1,\colorQbright}}}
